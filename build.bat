@echo off
echo.
echo ===============================================
echo       DRXQVLN LAUNCHER - AUTO BUILD
echo ===============================================
echo.

echo [–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê] –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: %CD%
echo [–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê] –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª—ã...
if not exist "package.json" (
    echo ‚ùå –û–®–ò–ë–ö–ê: –§–∞–π–ª package.json –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –±–∞—Ç–Ω–∏–∫ –≤ –ø–∞–ø–∫–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º.
    echo.
    pause
    exit /b 1
)
echo ‚úÖ package.json –Ω–∞–π–¥–µ–Ω

echo.
echo [1/4] –ü—Ä–æ–≤–µ—Ä—è–µ–º Node.js...
node --version
if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!
    echo.
    echo –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:
    echo - Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (—Å–∫–∞—á–∞–π—Ç–µ —Å https://nodejs.org/)
    echo - –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Node.js
    echo - –í –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º –∫–ª—É–±–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª—å–Ω—ã–º –∫–æ–º–∞–Ω–¥–∞–º
    echo.
    echo –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –†–ï–®–ï–ù–ò–Ø:
    echo 1. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Å–æ–ª—å
    echo 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ portable –≤–µ—Ä—Å–∏—é Node.js
    echo 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–±-–≤–µ—Ä—Å–∏—é –ª–∞—É–Ω—á–µ—Ä–∞ (—Å–æ–∑–¥–∞–º –æ—Ç–¥–µ–ª—å–Ω–æ)
    echo.
    pause
    exit /b 1
)
echo ‚úÖ Node.js –≤–µ—Ä—Å–∏—è: 
node --version

echo.
echo [–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê] –ü—Ä–æ–≤–µ—Ä—è–µ–º npm...
npm --version
if %errorlevel% neq 0 (
    echo ‚ùå npm –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!
    pause
    exit /b 1
)
echo ‚úÖ npm –≤–µ—Ä—Å–∏—è:
npm --version

echo.
echo [2/4] –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...
echo –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç...
npm install
if %errorlevel% neq 0 (
    echo.
    echo ‚ùå –û–®–ò–ë–ö–ê –£–°–¢–ê–ù–û–í–ö–ò –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô!
    echo.
    echo –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:
    echo - –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
    echo - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ—Å—Ç—É–ø –∫ npm registry
    echo - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –ø–∞–ø–∫—É
    echo - –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É
    echo.
    echo –ü–û–ü–†–û–ë–£–ô–¢–ï:
    echo npm cache clean --force
    echo npm install --registry https://registry.npm.taobao.org
    echo.
    pause
    exit /b 1
)
echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!

echo.
echo [3/4] –°–æ–±–∏—Ä–∞–µ–º React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ...
npm run react-build
if %errorlevel% neq 0 (
    echo.
    echo ‚ùå –û–®–ò–ë–ö–ê –°–ë–û–†–ö–ò REACT!
    echo –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
    echo.
    pause
    exit /b 1
)
echo ‚úÖ React —Å–æ–±—Ä–∞–Ω!

echo.
echo [4/4] –°–æ–∑–¥–∞–µ–º .exe —Ñ–∞–π–ª...
npm run dist
if %errorlevel% neq 0 (
    echo.
    echo ‚ùå –û–®–ò–ë–ö–ê –°–û–ó–î–ê–ù–ò–Ø .EXE!
    echo –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤—ã—à–µ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
    echo.
    pause
    exit /b 1
)

echo.
echo ===============================================
echo            ‚úÖ –ì–û–¢–û–í–û! ‚úÖ
echo ===============================================
echo.
echo üìÅ –ì–æ—Ç–æ–≤—ã–π .exe —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ: release/
echo üì¶ –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫: DRXQVLN LAUNCHER Setup.exe
echo üöÄ Portable: release/win-unpacked/DRXQVLN LAUNCHER.exe
echo.
pause
if exist "release" explorer release 